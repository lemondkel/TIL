JSP와 Servlet
------

## • Servlet(서블릿)    
➢ 자바를 사용해 웹을 만들기 위해 필요한 기술! (자바 프로그램)    
-> **클라이언트가 요청하면 그에 대한 결과를 다시 전송해주는 역할**   
사용자가 아이디/비번 입력 ► 로그인버튼 클릭 ► 서버는 클라이언트의 아이디/비번 확인 ► 다음 페이지 띄워줌   
-> 이런 역할을 수행하는게 서블릿!!!    
(=> 서블릿은 자바로 구현된 CGI라고 함)  

### ° Servlet 특징  
```
➢ 클라이언트의 요청에 대해 동적으로 작동하는 웹 어플리케이션 컴포넌트**  
➢ html을 사용해 요청에 응답
➢ 자바 Thread를 이해 동작  
➢ MVC 패턴에서 Controller로 이용됨
➢ HTTP 프로토콜 서비스를 지원하는 javax.servlet.http.HttpServlet 클래스 상속받음
➢ UDP보다 처리 속도 느림
➢ HTML 변경 시 Servlet을 재컴파일해야 하는 단점  
```

> **UDP**는 비연결형이며, 각각의 패킷은 다른 경로로 전송되고, TCP보다 속도가 빠르며 가볍지만 신뢰성 낮음 (실시간 서비스에 자주 사용)

&nbsp;  
&nbsp;  

#### 일반적으로 웹서버는 정적인 페이지만 제공!  
-> 동적인 페이지 제공하려면 웹서버는 다른 곳에 도움 요청해서 동적인 페이지 작성해야 함!!  
(동적인 페이지 : 임의의 이미지만을 보여주는 페이지와 같이 사용자가 요청한 시점에 페이지를 생성해서 전달해 주는 것)  

=> 여기서 웹서버가 **동적인 페이지를 제공할 수 있도록 도와주는** 어플리케이션이 **Servlet(서블릿)** 임!!!  
=> **동적인 페이지 생성**하는 어플리케이션이 **CGI** !!!  
> **CGI(Common Gateway Interface)**  
> ➢ 별도로 제작된 웹서버-프로그램간의 교환방식!  
> 
> -> CGI방식은 어떤 프로그래밍언어로도 구현이 가능!  
> 별도록 만들어놓은 프로그램에 HTML의 GET/POST 방법으로 클라이언트의 데이터를 환경변수로 전달하고,  
> 프로그램의 표준 출력 결과를 클라이언트에게 전송!  
> 
> **=> 웹 브라우저용 출력 화면을 만드는 방법!!!**  

&nbsp;  

### ° Servlet 동작 방식  
```
1. 클라이언트가 URL 입력하면 HTTP Request가 Servlet Container로 전송  
2. 요청 전송받은 Servlet Container는 HttpServletRequest, HttpServletResponse 객체 생성 
3. web.xml을 기반으로 URL이 어느 Servlet에 대한 요청인지 찾음 
4. 해당 Servlet에서 service메소드를 호출한 후 클라이언트의 GET, POST 여부에 따라 각각 doGet(), doPost() 호출  
5. doGet() or doPost() 메소드는 동적 페이지 생성 후 HttpServletResponse객체에 응답을 보냄
6. 응답 끝나면 HttpServletRequest, HttpServletResponse 두 객체를 소멸  
```
&nbsp;  
&nbsp;  

## • Servlet Container(서블릿 컨테이너)    
➢ 서블릿 관리해주는 컨테이너  
-> Servlet 만들었다 해서 스스로 작동 놉!! 관리해주는게 필요함!!  
=> 그걸 해주는게 서블릿 컨테이너!!  
#### 클라이언트의 요청 받고 응답할 수 있게, 웹서버와 소켓으로 통신!! (ex 톰캣)  

&nbsp;  

### ° Servlet Container 역할  

### 1. 웹서버와의 통신 지원  
➢ 서블릿과 웹서버가 쉽게 통신할 수 있게 해줌!!  
일반적으로 소켓을 만들고 listen, accept 등을 해야하지만 이러한 기능을 API로 제공해서 복잡한 과정 생략 가능하게 해줌!  
#### => 개발자가 서블릿에 구현해야 할 비즈니스 로직에 대해서만 초점 두게 도와줌!! 대박   

### 2. 서블릿 생명주기 관리  
➢ 서블릿의 탄생과 죽음을 관리!!  
(init(), service(), destroy())  

### 3. 멀티쓰레드 지원 및 관리  
➢ 서블릿 컨테이너는 요청 올 때마다 새로운 자바쓰레드 하나 생성하는데, HTTP `service()` 메소드 실행하고 나면, 쓰레드 자동으로 죽게됨!!  
-> 원래 쓰레드를 관리해야 하지만 서버가 다중쓰레드를 생성 및 운영해주니 쓰레드의 안정성에 대해 걱정하지 않아도 됨!!  

### 4. 선언적인 보안 관리  
➢ 서블릿 컨테이너 사용하면 개발자는 보안에 관련된 내용을 서블릿이나 자바 클래스에 구현해놓지 않아도 됨!!  
-> 일반적으로 보안관리는 XML 배포 서술자에 기록하므로, 보안에 대해 수정할 일 생겨도 자바 소스 코드를 수정하여 다시 컴파일 하지 않아도 보안 관리 가능!  

&nbsp;  
### ❓ Servlet 생명주기 ?!  
1. 클라이언트의 요청 들어오면 컨테이너는 해당 서블릿이 메모리에 있는지 확인하고 없으면 `init()`메소드 호출해 적재!  
  `init()`메소드는 처음 한 번만 실행돼서 서블릿의 쓰레드에서 공통적으로 사용해야 하는게 있다면 오버라이딩해서 구현하면 됨  
  실행 중 서블릿 변경되면, 기존 서블릿 파괴하고 `init()`으로 새로운 내용을 다시 메모리에 적재!!  

2. `init()`이 호출된 후 클라이언트의 요청에 따라 `service()`메소드를 통해 요청에 대한 응답이 `doGet()`, `doPost()`로 분리!  
  이 때 서블릿 컨테이너가 HttpServletRequest, HttpServletResponse에 의해 `request`와 `response`객체가 제공됨  

3. 컨테이너가 서블릿에 종료 요청하면 `destroy()`메소드가 호출되는데 이것도 한 번만 실행!  
  종료시 처리해야하는 작업들은 `destroy()`메소드 오버라이딩하여 구현하면 됨  
  
&nbsp;  


## • JSP (JavaServer Pages)
➢ Java 코드가 들어있는 HTML 코드!!  
-> **HTML 코드 속에 Java 코드가 들어가는 구조를 갖는 웹어플리케이션 프로그래밍 기술!!**  
(Servlet은 Java 코드 안에 HTML 코드인데, JSP는 반대)  
`<% 소스코드 %> 또는 <%= 소스코드 =%> 형태`  
  
➢ Java 코드로 작성된 부분은 웹 브라우저로 보내는게 아니라 **웹 서버에서 실행**!!  
-> 소스코드 수정할 때 디자인 부분 제외하고 Java 코드만 수정하면 돼서 효율 높여줌  
-> 또한 컴파일과 같은 과정 할 필요없이 **JSP페이지를 작성하여 웹 서버의 디렉토리에 추가만 하면** 사용 가능!  
=> Servlet 규칙 꽤 복잡해서 JSP가 나왔는데 JSP는 WAS에 의해 Servlet 클래스로 변환되어 사용됨!!  

&nbsp;  

### ❓ 웹 어플리케이션이 뭔데?!  
=> 웹에서 실행되는 응용프로그램을 뜻함!!! 
(인터넷 통해 하는 은행업무, 인터넷쇼핑 등 여러 서비스 총칭)  
-> **사용자**가 필요한 걸 **요청(Request)** 하고 **서버**에서는 해당 요청을 수행하고 **응답(Response)**!    

#### ° 웹 어플리케이션의 동작 위한 구성요소  
```
➢ 웹 브라우저 : 클라이언트가 요청하고 전달받은 페이지를 볼 수 있는 환경 (ex 크롬, 사파리 등등)  
➢ 웹 서버: 클라이언트로부터 요청받아 서버에 저장된 리소스를 클라이언트에게 전달 (주로 정적 컨텐츠 담당)  
➢ 웹 어플리케이션 서버(WAS) : 서버단에서 필요한 기능 수행하고 그 결과를 웹 서버에 전달   
➢ 데이터베이스 : 서비스에 필요한 데이터를 보관, 갱신 등 관리 
```

&nbsp;  

### ° JSP 동작 구조   
> ➢ 웹서버가 사용자로부터 Servlet에 대한 요청 받으면 Servlet Container에 그 요청 넘김  
> ➢ 요청 받은 컨테이너는 HTTP Request와 HTTP Response 객체를 만들어, 이를 통해 `doPost(`, `doGet()` 메소드 중 하나를 호출  
만약 Servlet만 사용하여 사용자가 요청한 웹페이지 보여주려면 out 객체의 println 메소드를 사용해 HTML 문서 작성해야함  
-> 그러면 추가/수정 어렵고 가독성 떨어짐 ㅠ  
#### => JSP 사용해 비즈니스 로직과 프레젠테이션 로직 분리!!  
-> 여기서 Servlet은 데이터의 입력, 수정 등에 대한 제어를 JSP로 넘겨서 프레젠테이션 로직 수행한 후 컨테이너에게 Response를 전달  
-> 만들어진 결과물은 사용자가 해당 페이지를 요청하면 컴파일이 되어 자바 파일을 통해 `.class` 파일이 만들어지고, 두 로직(비즈니스, 프레젠테이션)이 결합되어 클래스화 되는 것 확인 가능!!  
#### => out객체의 println 메소드를 사용해서 구현해야하는 번거로움을 JSP가 대신 수행해줌!!  
